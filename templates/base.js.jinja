{% macro script_gestao_conta() %}

document.getElementById("user_dropdown_button").onclick = function() {
    var dropdown_usuario = document.getElementById("dropdown_usuario");
    if (dropdown_usuario.style.display == "block") {
        dropdown_usuario.style.display = "none";
    } else {
        dropdown_usuario.style.display = "block";
    }
}

document.getElementById("sair_conta_button").onclick = function() {
    fetch('/conta_sair', {
        method: 'POST'
    })
    .then(response => {
        location.reload();
    })
    .catch(error => {
        alert('Erro ao sair da conta: ' + error);
    });
}

document.getElementById("deletar_conta_button").onclick = function() {
    if (!window.confirm("Tem certeza que quer deletar sua conta?\nTodos os seu campeonantos tambem serão deletados.\nEssa ação não tem volta.")) {
        return;
    }

    fetch('/conta_deletar', {
        method: 'DELETE'
    })
    .then(response => {
        location.reload();
    })
    .catch(error => {
        alert('Erro ao deletar conta: ' + error);
    });
}

{% endmacro %}

{% macro script_login_modal() %}

document.getElementById("action_login_button").onclick = function() {
    var email = document.querySelector('#login_modal input[name="email"]').value;
    var senha = document.querySelector('#login_modal input[name="senha"]').value;
    
    var formData = new FormData();
    formData.append('email', email);
    formData.append('senha', senha);
    
    fetch('/conta_entrar', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            location.reload();
        } else {
            alert(data.message);
        }
    })
    .catch(error => {
        alert('Erro de conexão: ' + error);
    });
}

document.getElementById("to_signin_button").onclick = function() {
    document.getElementById("login_modal").style.display = "none";
    document.getElementById("signin_modal").style.display = "block";
}

{% endmacro %}

{% macro script_signin_modal() %}

document.getElementById("action_signin_button").onclick = function() {
    var nome = document.querySelector('#signin_modal input[name="nome"]').value;
    var email = document.querySelector('#signin_modal input[name="email"]').value;
    var senha = document.querySelector('#signin_modal input[name="senha"]').value;
    
    var formData = new FormData();
    formData.append('nome', nome);
    formData.append('email', email);
    formData.append('senha', senha);
    
    fetch('/conta_cadastrar', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            location.reload();
        } else {
            alert(data.message);
        }
    })
    .catch(error => {
        alert('Erro de conexão: ' + error);
    });
}

document.getElementById("to_login_button").onclick = function() {
    document.getElementById("login_modal").style.display = "block";
    document.getElementById("signin_modal").style.display = "none";
}

{% endmacro %}
